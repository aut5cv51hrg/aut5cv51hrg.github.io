<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Autenticación</title>
    <link rel="stylesheet" href="estilos.css">

    <!-- Carga el núcleo de Firebase JS SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <!-- Agrega el manejo de autenticación. -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="js/init.js"></script>
  </head>
  <body>
    <h1>Autenticación</h1>
    <h1>Sesión</h1>
    <fieldset>
      <legend>Email</legend>
      <output id="email"><progress max="100">Cargando…</progress></output>
    </fieldset>
    <fieldset>
      <legend>Nombre</legend>
      <output id="nombre"></output>
    </fieldset>
    <figure><img id="avatar" alt="Avatar"></figure>
    <button type="button" onclick="terminaSesión()">Terminar Sesión</button>
    <form id="signup-form">
      <input type="email" id="signup-email" placeholder="Email">
      <input type="password" id="signup-password" placeholder="Contraseña">
      <button type="submit">Registrarse</button>
    </form>
    <form id="login-form">
      <input type="email" id="login-email" placeholder="Email">
      <input type="password" id="login-password" placeholder="Contraseña">
      <button type="submit">Iniciar Sesión</button>
    </form>
    <script>
      //@ts-check
      /** Conexión al sistema de autenticación de Firebase. */
      // @ts-ignore
      const auth = firebase.auth();
      /** Tipo de autenticación de usuarios. En este caso es con email/contraseña. */

      // Handles the signup form submission
      document.getElementById("signup-form").addEventListener("submit", function(event) {
        event.preventDefault(); // Prevent form submission
        const email = document.getElementById("signup-email").value;
        const password = document.getElementById("signup-password").value;
        auth.createUserWithEmailAndPassword(email, password)
          .then((userCredential) => {
            // User signed up
            const user = userCredential.user;
            console.log("User signed up:", user);
            // ...
          })
          .catch((error) => {
            const errorCode = error.code;
            const errorMessage = error.message;
            console.error("Signup error:", errorMessage);
            // ...
          });
      });

      // Handles the login form submission
      document.getElementById("login-form").addEventListener("submit", function(event) {
        event.preventDefault(); // Prevent form submission
        const email = document.getElementById("login-email").value;
        const password = document.getElementById("login-password").value;
        auth.signInWithEmailAndPassword(email, password)
          .then((userCredential) => {
            // User signed in
            const user = userCredential.user;
            console.log("User signed in:", user);
            // ...
          })
          .catch((error) => {
            const errorCode = error.code;
            const errorMessage = error.message;
            console.error("Login error:", errorMessage);
            // ...
          });
      });

      // Handles the sign out button click
      function terminaSesión() {
        auth.signOut()
          .then(() => {
            console.log("User signed out");
            // ...
          })
          .catch((error) => {
            console.error("Signout error:", error);
            // ...
          });
      }

      /* Rest of the code remains the same */
    </script>
  </body>
</html>
